<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Inequality by Demographic Factors - Basel</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Inequality by Demographic Factors - Basel</h1>

<p>Load Library</p>

<pre><code class="r">library(foreign,quietly=TRUE,warn.conflicts=FALSE)
library(plyr,quietly=TRUE,warn.conflicts=FALSE)
library(dplyr,quietly=TRUE,warn.conflicts=FALSE)
library(ggplot2,quietly=TRUE,warn.conflicts=FALSE)
library(ineq,quietly=TRUE,warn.conflicts=FALSE)
library(IC2,quietly=TRUE,warn.conflicts=FALSE)
</code></pre>

<p>Load Data </p>

<pre><code class="r">load(&quot;P:/WGS/FBS/ISS/Projekte laufend/SNF Ungleichheit/Valorisierung/Ungleichheitsworkshop Neuchatel 2014/Inequality by demographic factors/Auswertungen/datenbs1.Rda&quot;)
load(&quot;P:/WGS/FBS/ISS/Projekte laufend/SNF Ungleichheit/Valorisierung/Ungleichheitsworkshop Neuchatel 2014/Inequality by demographic factors/Auswertungen/datenbs2.Rda&quot;)
</code></pre>

<p>Achtung: </p>

<ul>
<li>Einkommen sind nicht preisbereinigt. Vergleich der Mittelwerte über die Zeit sind damit nicht zu interpretieren</li>
<li>Es wird die Ungleichheit zwischen Steuereinheiten und nicht zwischen Haushalten untersucht</li>
<li>Es wurde keine Äquivalenzgewichtung vorgenommen</li>
</ul>

<p><br><br>
<br><br></p>

<h1>Change of social structure and between group inequality</h1>

<h2>Periode 1: 1991 to 2003</h2>

<h3>1991</h3>

<p><strong>Agegroup and mean taxable income</strong></p>

<pre><code class="r">prop.table(table(datenbs1$agegroup[datenbs1$steuerjahr==1991]))
</code></pre>

<pre><code>## 
##  18-25  26-65    66+ 
## 0.1185 0.6255 0.2561
</code></pre>

<pre><code class="r">by(datenbs1$einkommen_steuerbar[datenbs1$steuerjahr==1991],datenbs1$agegroup[datenbs1$steuerjahr==1991],mean)
</code></pre>

<pre><code>## datenbs1$agegroup[datenbs1$steuerjahr == 1991]: 18-25
## [1] 22675
## -------------------------------------------------------- 
## datenbs1$agegroup[datenbs1$steuerjahr == 1991]: 26-65
## [1] 57229
## -------------------------------------------------------- 
## datenbs1$agegroup[datenbs1$steuerjahr == 1991]: 66+
## [1] 46521
</code></pre>

<p><strong>Housholdstructur and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs1$household[datenbs1$steuerjahr==1991]))
</code></pre>

<pre><code>## 
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.294072               0.140257               0.228321 
##           Single women             Single dad             Single mom 
##               0.325016               0.005760               0.006575
</code></pre>

<pre><code class="r">by(datenbs1$einkommen_steuerbar[datenbs1$steuerjahr==1991],datenbs1$household[datenbs1$steuerjahr==1991],mean)
</code></pre>

<pre><code>## datenbs1$household[datenbs1$steuerjahr == 1991]: Married with Kid(s)
## [1] 63978
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Married without Kid(s)
## [1] 73856
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single man
## [1] 40975
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single women
## [1] 34986
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single dad
## [1] 68334
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single mom
## [1] 34010
</code></pre>

<h3>2003</h3>

<p><strong>Agegroup and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs1$agegroup[datenbs1$steuerjahr==2003]))
</code></pre>

<pre><code>## 
##  18-25  26-65    66+ 
## 0.1180 0.6274 0.2545
</code></pre>

<pre><code class="r">by(datenbs1$einkommen_steuerbar[datenbs1$steuerjahr==2003],datenbs1$agegroup[datenbs1$steuerjahr==2003],mean)
</code></pre>

<pre><code>## datenbs1$agegroup[datenbs1$steuerjahr == 2003]: 18-25
## [1] 17961
## -------------------------------------------------------- 
## datenbs1$agegroup[datenbs1$steuerjahr == 2003]: 26-65
## [1] 65479
## -------------------------------------------------------- 
## datenbs1$agegroup[datenbs1$steuerjahr == 2003]: 66+
## [1] 56526
</code></pre>

<p><strong>Housholdstructur and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs1$household[datenbs1$steuerjahr==2003]))
</code></pre>

<pre><code>## 
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.244465               0.133485               0.269064 
##           Single women             Single dad             Single mom 
##               0.343172               0.001384               0.008430
</code></pre>

<pre><code class="r">by(datenbs1$einkommen_steuerbar[datenbs1$steuerjahr==2003],datenbs1$household[datenbs1$steuerjahr==2003],mean)
</code></pre>

<pre><code>## datenbs1$household[datenbs1$steuerjahr == 2003]: Married with Kid(s)
## [1] 81716
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 2003]: Married without Kid(s)
## [1] 83996
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 2003]: Single man
## [1] 43989
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 2003]: Single women
## [1] 42405
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 2003]: Single dad
## [1] 61012
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 2003]: Single mom
## [1] 39298
</code></pre>

<p><br><br>
<br><br></p>

<h2>Periode 2: 2006 to 2011</h2>

<h3>2006</h3>

<p><strong>Agegroup and mean Total income</strong></p>

<pre><code class="r">prop.table(table(datenbs2$agegroup[datenbs2$steuerjahr==2006]))
</code></pre>

<pre><code>## 
##  18-25  26-65    66+ 
## 0.1229 0.6244 0.2527
</code></pre>

<pre><code class="r">by(datenbs2$TOTEINK[datenbs2$steuerjahr==2006],datenbs2$agegroup[datenbs2$steuerjahr==2006],mean)
</code></pre>

<pre><code>## datenbs2$agegroup[datenbs2$steuerjahr == 2006]: 18-25
## [1] 20135
## -------------------------------------------------------- 
## datenbs2$agegroup[datenbs2$steuerjahr == 2006]: 26-65
## [1] 84115
## -------------------------------------------------------- 
## datenbs2$agegroup[datenbs2$steuerjahr == 2006]: 66+
## [1] 71721
</code></pre>

<p><strong>Housholdstructur and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs2$household[datenbs2$steuerjahr==2006]))
</code></pre>

<pre><code>## 
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.232347               0.129318               0.278446 
##           Single women             Single dad             Single mom 
##               0.348484               0.001999               0.009405
</code></pre>

<pre><code class="r">by(datenbs2$TOTEINK[datenbs2$steuerjahr==2006],datenbs2$household[datenbs2$steuerjahr==2006],mean)
</code></pre>

<pre><code>## datenbs2$household[datenbs2$steuerjahr == 2006]: Married with Kid(s)
## [1] 101553
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2006]: Married without Kid(s)
## [1] 126485
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2006]: Single man
## [1] 51005
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2006]: Single women
## [1] 51798
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2006]: Single dad
## [1] 90459
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2006]: Single mom
## [1] 113626
</code></pre>

<h3>2011</h3>

<p><strong>Agegroup and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs2$agegroup[datenbs2$steuerjahr==2011]))
</code></pre>

<pre><code>## 
##  18-25  26-65    66+ 
## 0.1219 0.6272 0.2509
</code></pre>

<pre><code class="r">by(datenbs2$TOTEINK[datenbs2$steuerjahr==2011],datenbs2$agegroup[datenbs2$steuerjahr==2011],mean)
</code></pre>

<pre><code>## datenbs2$agegroup[datenbs2$steuerjahr == 2011]: 18-25
## [1] 20306
## -------------------------------------------------------- 
## datenbs2$agegroup[datenbs2$steuerjahr == 2011]: 26-65
## [1] 89110
## -------------------------------------------------------- 
## datenbs2$agegroup[datenbs2$steuerjahr == 2011]: 66+
## [1] 76405
</code></pre>

<p><strong>Housholdstructur and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs2$household[datenbs2$steuerjahr==2011]))
</code></pre>

<pre><code>## 
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.207103               0.127996               0.295390 
##           Single women             Single dad             Single mom 
##               0.356978               0.001906               0.010628
</code></pre>

<pre><code class="r">by(datenbs2$TOTEINK[datenbs2$steuerjahr==2011],datenbs2$household[datenbs2$steuerjahr==2011],mean)
</code></pre>

<pre><code>## datenbs2$household[datenbs2$steuerjahr == 2011]: Married with Kid(s)
## [1] 114502
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Married without Kid(s)
## [1] 134290
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single man
## [1] 54428
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single women
## [1] 55952
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single dad
## [1] 92523
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single mom
## [1] 67811
</code></pre>

<p><br><br>
<br><br></p>

<h2>Periode 3: 1991 to 2011</h2>

<h3>1991</h3>

<p><strong>Agegroup and mean Reineinkommen</strong></p>

<pre><code class="r">prop.table(table(datenbs1$agegroup[datenbs1$steuerjahr==1991]))
</code></pre>

<pre><code>## 
##  18-25  26-65    66+ 
## 0.1185 0.6255 0.2561
</code></pre>

<pre><code class="r">by(datenbs1$reineinkommen[datenbs1$steuerjahr==1991],datenbs1$agegroup[datenbs1$steuerjahr==1991],mean)
</code></pre>

<pre><code>## datenbs1$agegroup[datenbs1$steuerjahr == 1991]: 18-25
## [1] 23915
## -------------------------------------------------------- 
## datenbs1$agegroup[datenbs1$steuerjahr == 1991]: 26-65
## [1] 64720
## -------------------------------------------------------- 
## datenbs1$agegroup[datenbs1$steuerjahr == 1991]: 66+
## [1] 52669
</code></pre>

<p><strong>Agegroup (more categories) and mean Reineinkommen</strong></p>

<pre><code class="r">prop.table(table(datenbs1$alterskategorie[datenbs1$steuerjahr==1991]))
</code></pre>

<pre><code>## 
##    00_26    26_35    36_45    46_55    56_65    66_75    76_85    86_95 
## 0.118457 0.191556 0.154902 0.143182 0.135847 0.120052 0.102037 0.032700 
##     95_+ 
## 0.001266
</code></pre>

<pre><code class="r">by(datenbs1$reineinkommen[datenbs1$steuerjahr==1991],datenbs1$alterskategorie[datenbs1$steuerjahr==1991],mean)
</code></pre>

<pre><code>## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 00_26
## [1] 23915
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 26_35
## [1] 46726
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 36_45
## [1] 66642
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 46_55
## [1] 78017
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 56_65
## [1] 73888
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 66_75
## [1] 60182
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 76_85
## [1] 47569
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 86_95
## [1] 41979
## -------------------------------------------------------- 
## datenbs1$alterskategorie[datenbs1$steuerjahr == 1991]: 95_+
## [1] 27367
</code></pre>

<p><strong>Housholdstructur and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs1$household[datenbs1$steuerjahr==1991]))
</code></pre>

<pre><code>## 
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.294072               0.140257               0.228321 
##           Single women             Single dad             Single mom 
##               0.325016               0.005760               0.006575
</code></pre>

<pre><code class="r">by(datenbs1$reineinkommen[datenbs1$steuerjahr==1991],datenbs1$household[datenbs1$steuerjahr==1991],mean)
</code></pre>

<pre><code>## datenbs1$household[datenbs1$steuerjahr == 1991]: Married with Kid(s)
## [1] 70837
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Married without Kid(s)
## [1] 92126
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single man
## [1] 43487
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single women
## [1] 37755
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single dad
## [1] 88073
## -------------------------------------------------------- 
## datenbs1$household[datenbs1$steuerjahr == 1991]: Single mom
## [1] 52446
</code></pre>

<h3>2011</h3>

<p><strong>Agegroup and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs2$agegroup[datenbs2$steuerjahr==2011]))
</code></pre>

<pre><code>## 
##  18-25  26-65    66+ 
## 0.1219 0.6272 0.2509
</code></pre>

<pre><code class="r">by(datenbs2$reineinkommen[datenbs2$steuerjahr==2011],datenbs2$agegroup[datenbs2$steuerjahr==2011],mean)
</code></pre>

<pre><code>## datenbs2$agegroup[datenbs2$steuerjahr == 2011]: 18-25
## [1] 16176
## -------------------------------------------------------- 
## datenbs2$agegroup[datenbs2$steuerjahr == 2011]: 26-65
## [1] 73350
## -------------------------------------------------------- 
## datenbs2$agegroup[datenbs2$steuerjahr == 2011]: 66+
## [1] 67091
</code></pre>

<p><strong>Agegroup (more categories) and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs2$alterskategorie[datenbs2$steuerjahr==2011]))
</code></pre>

<pre><code>## 
##    00_26    26_35    36_45    46_55    56_65    66_75    76_85    86_95 
## 0.121892 0.163054 0.157586 0.168929 0.137642 0.110973 0.093914 0.042595 
##     95_+ 
## 0.003415
</code></pre>

<pre><code class="r">by(datenbs2$reineinkommen[datenbs2$steuerjahr==2011],datenbs2$alterskategorie[datenbs2$steuerjahr==2011],mean)
</code></pre>

<pre><code>## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 00_26
## [1] 16176
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 26_35
## [1] 50810
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 36_45
## [1] 76068
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 46_55
## [1] 82379
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 56_65
## [1] 85860
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 66_75
## [1] 71582
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 76_85
## [1] 67855
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 86_95
## [1] 56056
## -------------------------------------------------------- 
## datenbs2$alterskategorie[datenbs2$steuerjahr == 2011]: 95_+
## [1] 37840
</code></pre>

<p><strong>Housholdstructur and mean income</strong></p>

<pre><code class="r">prop.table(table(datenbs2$household[datenbs2$steuerjahr==2011]))
</code></pre>

<pre><code>## 
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.207103               0.127996               0.295390 
##           Single women             Single dad             Single mom 
##               0.356978               0.001906               0.010628
</code></pre>

<pre><code class="r">by(datenbs2$reineinkommen[datenbs2$steuerjahr==2011],datenbs2$household[datenbs2$steuerjahr==2011],mean)
</code></pre>

<pre><code>## datenbs2$household[datenbs2$steuerjahr == 2011]: Married with Kid(s)
## [1] 96862
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Married without Kid(s)
## [1] 111522
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single man
## [1] 45887
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single women
## [1] 45971
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single dad
## [1] 76478
## -------------------------------------------------------- 
## datenbs2$household[datenbs2$steuerjahr == 2011]: Single mom
## [1] 56811
</code></pre>

<p><br><br>
<br><br></p>

<h1>Change of overall inequality</h1>

<h2>Periode 3: 1991 to 2011</h2>

<h3>1991</h3>

<pre><code class="r">Gini(datenbs1$reineinkommen[datenbs1$steuerjahr==1991])
</code></pre>

<pre><code>## [1] 0.4349
</code></pre>

<pre><code class="r">Theil(datenbs1$reineinkommen[datenbs1$steuerjahr==1991])
</code></pre>

<pre><code>## [1] 0.3903
</code></pre>

<h3>2011</h3>

<pre><code class="r">Gini(datenbs2$reineinkommen[datenbs2$steuerjahr==2011])
</code></pre>

<pre><code>## [1] 0.4916
</code></pre>

<pre><code class="r">Theil(datenbs2$reineinkommen[datenbs2$steuerjahr==2011])
</code></pre>

<pre><code>## [1] 0.4864
</code></pre>

<h3>Lorenz curve</h3>

<pre><code class="r">Lc.1991&lt;-Lc(datenbs1$reineinkommen[datenbs1$steuerjahr==1991])
Lc.2011&lt;-Lc(datenbs2$reineinkommen[datenbs2$steuerjahr==2011])

plot(Lc.1991,lty=&quot;dotted&quot;)
lines(Lc.2011$p, Lc.2011$L,lty=&quot;dashed&quot;, lwd=1.2, col=4)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-19"/> </p>

<h2>Change of inequality measured with calcGEI (THEIL)</h2>

<pre><code class="r"># calcGEI kann nix mit 0 anfangen, macht aber das selbe
x.1991&lt;-datenbs1$reineinkommen[datenbs1$steuerjahr==1991]
x.1991[x.1991==0]&lt;-1
calcGEI(x.1991)
</code></pre>

<pre><code>## $ineq
## $ineq$index
##    GEI 
## 0.4222 
## 
## $ineq$parameter
## alpha 
##     1 
## 
## 
## $nas
## $nas$xNA
## [1] 0
## 
## $nas$wNA
## NULL
## 
## $nas$totalNA
## [1] 0
## 
## 
## attr(,&quot;class&quot;)
## [1] &quot;ICI&quot;
</code></pre>

<pre><code class="r">Theil(x.1991)
</code></pre>

<pre><code>## [1] 0.4222
</code></pre>

<pre><code class="r">x.2011&lt;-datenbs1$reineinkommen[datenbs2$steuerjahr==2011]
x.2011[x.2011==0]&lt;-1
calcGEI(x.2011)
</code></pre>

<pre><code>## $ineq
## $ineq$index
##    GEI 
## 0.5021 
## 
## $ineq$parameter
## alpha 
##     1 
## 
## 
## $nas
## $nas$xNA
## [1] 0
## 
## $nas$wNA
## NULL
## 
## $nas$totalNA
## [1] 0
## 
## 
## attr(,&quot;class&quot;)
## [1] &quot;ICI&quot;
</code></pre>

<pre><code class="r">Theil(x.2011)
</code></pre>

<pre><code>## [1] 0.5021
</code></pre>

<p><br><br>
<br><br></p>

<h1>Decomposing overall inequality</h1>

<h2>Households</h2>

<h3>1991</h3>

<pre><code class="r">decompGEI(x.1991,datenbs1$household[datenbs1$steuerjahr==1991])
</code></pre>

<pre><code>## $ineq
## $ineq$index
##   GEI 
## 0.427 
## 
## $ineq$parameter
## alpha 
##     1 
## 
## 
## $decomp
## $decomp$within
## [1] 0.3676
## 
## $decomp$between
## [1] 0.05944
## 
## $decomp$betweenELMO
## [1] 0.2769
## 
## 
## $intra
## $intra$GEIGroups
##    Married with Kid(s) Married without Kid(s)             Single man 
##                 0.4287                 0.2458                 0.3775 
##           Single women             Single dad             Single mom 
##                 0.3973                 0.1821                 0.1609 
## 
## $intra$contribGEIGroups
##    Married with Kid(s) Married without Kid(s)             Single man 
##              0.1572244              0.0559204              0.0659917 
##           Single women             Single dad             Single mom 
##              0.0858167              0.0016264              0.0009766 
## 
## 
## $ws
## $ws$wIntra
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.294072               0.140257               0.228321 
##           Single women             Single dad             Single mom 
##               0.325016               0.005760               0.006575 
## 
## $ws$sIntra
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.366718               0.227468               0.174792 
##           Single women             Single dad             Single mom 
##               0.216022               0.008930               0.006071 
## 
## 
## $nas
## $nas$xNA
## [1] 0
## 
## $nas$zNA
## [1] 1250
## 
## $nas$wNA
## NULL
## 
## $nas$totalNA
## [1] 1250
## 
## 
## attr(,&quot;class&quot;)
## [1] &quot;ICI&quot;
</code></pre>

<h3>2011</h3>

<pre><code class="r">decompGEI(x.2011,datenbs2$household[datenbs2$steuerjahr==2011])
</code></pre>

<pre><code>## $ineq
## $ineq$index
##    GEI 
## 0.5067 
## 
## $ineq$parameter
## alpha 
##     1 
## 
## 
## $decomp
## $decomp$within
## [1] 0.5063
## 
## $decomp$between
## [1] 0.000462
## 
## $decomp$betweenELMO
## [1] 0.26
## 
## 
## $intra
## $intra$GEIGroups
##    Married with Kid(s) Married without Kid(s)             Single man 
##                 0.3850                 0.4476                 0.4333 
##           Single women             Single dad             Single mom 
##                 0.6540                 0.4260                 0.3450 
## 
## $intra$contribGEIGroups
##    Married with Kid(s) Married without Kid(s)             Single man 
##              0.0772986              0.0569042              0.1259467 
##           Single women             Single dad             Single mom 
##              0.2421479              0.0006771              0.0033105 
## 
## 
## $ws
## $ws$wIntra
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.207103               0.127996               0.295390 
##           Single women             Single dad             Single mom 
##               0.356978               0.001906               0.010628 
## 
## $ws$sIntra
##    Married with Kid(s) Married without Kid(s)             Single man 
##               0.200791               0.127129               0.290640 
##           Single women             Single dad             Single mom 
##               0.370254               0.001590               0.009597 
## 
## 
## $nas
## $nas$xNA
## [1] 0
## 
## $nas$zNA
## [1] 1937
## 
## $nas$wNA
## NULL
## 
## $nas$totalNA
## [1] 1937
## 
## 
## attr(,&quot;class&quot;)
## [1] &quot;ICI&quot;
</code></pre>

<h4>Interpretation</h4>

<ul>
<li>Ungleichheit ist von 1991 bis 2011 gestiegen (0.43 auf 0.51)</li>
<li>Dies ist mit einer Zunahme der within-inequality und einer Abnahme der between-inequality verbunden</li>
<li>Die within Group inequality war 1991 bei den Verheirateten mit Kinder am grössten, diese Gruppe hat auch am meisten zur overall inequality beigetragen (16%?), 2011 ist die Ungleichheit stark durch die Gruppen single Man (13%) und Women (24%) getrieben, während die Beitrag der Ungleichheit bei den Verheirateten mit Kindern (8%) an Bedeutung verloren hat. Generell ist der Anteil der Verheirateten zurückgegangen, während der Anteil an Singels stark zugenommen hat.</li>
<li>Der Wandel der Lebensentwürfe scheint sich in den Daten niederzuschlagen und auch einen Teil der Zunahme der Overall inequality zu &ldquo;erklären&rdquo;</li>
<li>Alleinerziehende tragen nicht viel zur Overall inequality bei, obwohl der Anteil an Alleinerziehenden Mütter geringfügig zugenommen hat und diese Gruppe im Mittel über deutlich am wenigsten Einkommen verfügt. Es sind aber einfach sehr wenige.</li>
</ul>

<h2>Agegroups</h2>

<h3>1991</h3>

<pre><code class="r">decompGEI(x.1991,datenbs1$agegroup[datenbs1$steuerjahr==1991])
</code></pre>

<pre><code>## $ineq
## $ineq$index
##    GEI 
## 0.4222 
## 
## $ineq$parameter
## alpha 
##     1 
## 
## 
## $decomp
## $decomp$within
## [1] 0.3902
## 
## $decomp$between
## [1] 0.03195
## 
## $decomp$betweenELMO
## [1] 0.174
## 
## 
## $intra
## $intra$GEIGroups
##  18-25  26-65    66+ 
## 0.3876 0.3059 0.6439 
## 
## $intra$contribGEIGroups
##   18-25   26-65     66+ 
## 0.01933 0.21803 0.15287 
## 
## 
## $ws
## $ws$wIntra
##  18-25  26-65    66+ 
## 0.1185 0.6255 0.2561 
## 
## $ws$sIntra
##   18-25   26-65     66+ 
## 0.04987 0.71270 0.23743 
## 
## 
## $nas
## $nas$xNA
## [1] 0
## 
## $nas$zNA
## [1] 0
## 
## $nas$wNA
## NULL
## 
## $nas$totalNA
## [1] 0
## 
## 
## attr(,&quot;class&quot;)
## [1] &quot;ICI&quot;
</code></pre>

<h3>2011</h3>

<pre><code class="r">decompGEI(x.2011,datenbs2$agegroup[datenbs2$steuerjahr==2011])
</code></pre>

<pre><code>## $ineq
## $ineq$index
##    GEI 
## 0.5021 
## 
## $ineq$parameter
## alpha 
##     1 
## 
## 
## $decomp
## $decomp$within
## [1] 0.502
## 
## $decomp$between
## [1] 4.234e-05
## 
## $decomp$betweenELMO
## [1] 0.2626
## 
## 
## $intra
## $intra$GEIGroups
##  18-25  26-65    66+ 
## 0.4003 0.4981 0.5594 
## 
## $intra$contribGEIGroups
##   18-25   26-65     66+ 
## 0.04774 0.31245 0.14183 
## 
## 
## $ws
## $ws$wIntra
##  18-25  26-65    66+ 
## 0.1219 0.6272 0.2509 
## 
## $ws$sIntra
##  18-25  26-65    66+ 
## 0.1193 0.6272 0.2535 
## 
## 
## $nas
## $nas$xNA
## [1] 0
## 
## $nas$zNA
## [1] 0
## 
## $nas$wNA
## NULL
## 
## $nas$totalNA
## [1] 0
## 
## 
## attr(,&quot;class&quot;)
## [1] &quot;ICI&quot;
</code></pre>

<h4>Interpretation</h4>

<ul>
<li>Bedetung der Between Group inequality hat abgenommmen</li>
<li>Die Anteile der Altersgruppen ist relativ konstant geblieben</li>
<li>Die Ungleichheit bei den Rentern hat sich markant reduziert</li>
<li>Dafür ist die Ungleichheit innerhalb der Erwerbsbevölkerung stark gestiegen.</li>
<li>Ebenso die Bedeutung der Ungleichheit dieser Gruppe für die Overall Ungleichheit</li>
</ul>

</body>

</html>

