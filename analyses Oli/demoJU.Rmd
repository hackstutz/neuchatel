Inequality by Demographic Factors - Jura
========================================================



Load Library
```{r}
library(foreign,quietly=TRUE,warn.conflicts=FALSE)
library(plyr,quietly=TRUE,warn.conflicts=FALSE)
library(dplyr,quietly=TRUE,warn.conflicts=FALSE)
library(ggplot2,quietly=TRUE,warn.conflicts=FALSE)
library(ineq,quietly=TRUE,warn.conflicts=FALSE)
library(IC2,quietly=TRUE,warn.conflicts=FALSE)
```

Load Data 
```{r}
load("P:/WGS/FBS/ISS/Projekte laufend/SNF Ungleichheit/Valorisierung/Ungleichheitsworkshop Neuchatel 2014/Inequality by demographic factors/Auswertungen/datenju.Rda")
```


Achtung: 
* Einkommen sind nicht preisbereinigt. Vergleich der Mittelwerte über die Zeit sind damit nicht zu interpretieren
* Es wird die Ungleichheit zwischen Steuereinheiten und nicht zwischen Haushalten untersucht
* Es wurde keine Äquivalenzgewichtung vorgenommen


<br><br>
<br><br>

# Change of social structure and between group inequality


## Periode: 2006 to 2011

```{r}
datenju$TOTEINK[datenju$TOTEINK<1]<-1
```


### 2006

**Agegroup and mean Total income**
```{r}
prop.table(table(datenju$agegroup[datenju$steuerjahr==2006]))
by(datenju$TOTEINK[datenju$steuerjahr==2006],datenju$agegroup[datenju$steuerjahr==2006],mean)
```

**Housholdstructur and mean income**
```{r}
prop.table(table(datenju$household[datenju$steuerjahr==2006]))
by(datenju$TOTEINK[datenju$steuerjahr==2006],datenju$household[datenju$steuerjahr==2006],mean)
```


### 2011

**Agegroup and mean income**
```{r}
prop.table(table(datenju$agegroup[datenju$steuerjahr==2011]))
by(datenju$TOTEINK[datenju$steuerjahr==2011],datenju$agegroup[datenju$steuerjahr==2011],mean)
```

**Housholdstructur and mean income**
```{r}
prop.table(table(datenju$household[datenju$steuerjahr==2011]))
by(datenju$TOTEINK[datenju$steuerjahr==2011],datenju$household[datenju$steuerjahr==2011],mean)
```

<br><br>
<br><br>




# Change of overall inequality

## Periode 2006 to 2011

### 2006

```{r}
Gini(datenju$TOTEINK[datenju$steuerjahr==2006])
Theil(datenju$TOTEINK[datenju$steuerjahr==2006])
```


### 2011

```{r}
Gini(datenju$TOTEINK[datenju$steuerjahr==2011])
Theil(datenju$TOTEINK[datenju$steuerjahr==2011])

```


### Lorenz curve

```{r}
Lc.2006<-Lc(datenju$TOTEINK[datenju$steuerjahr==2006])
Lc.2011<-Lc(datenju$TOTEINK[datenju$steuerjahr==2011])

plot(Lc.2006,lty="dotted")
lines(Lc.2011$p, Lc.2011$L,lty="dashed", lwd=1.2, col=4)
```

## Change of inequality measured with calcGEI (THEIL)

```{r}
# calcGEI kann nix mit 0 anfangen, macht aber das selbe
x.2006<-datenju$TOTEINK[datenju$steuerjahr==2006]
x.2006[x.2006<1]<-1
calcGEI(x.2006)
Theil(x.2006)

x.2011<-datenju$TOTEINK[datenju$steuerjahr==2011]
x.2011[x.2011<1]<-1
calcGEI(x.2011)
Theil(x.2011)


```


<br><br>
<br><br>

# Decomposing overall inequality

## Households

### 2006
 
```{r}
decompGEI(x.2006,datenju$household[datenju$steuerjahr==2006])
```


### 2011

```{r}
decompGEI(x.2011,datenju$household[datenju$steuerjahr==2011])
```


#### Interpretation

* Grundsätzlich: Der Anteil lediger ist extrem hoch (fast 60%) das ist aber auch bei den Brülhartdaten so. Trotzdem irgendwie strange...
* Overall Ungleichheit nimmt geringfügig zu, nicht aber, weil Between-Group inequality grösser geworden wäre
* Beitrag der Between-Group Ungleichheit zur Overall Ungleichheit ist sehr hoch (2006:36.6%, 2011:36.9%) 
* Verheiratete ohne Kinder verfügen über ein deutlich höheres Einkommen wie die übliche Gruppen


## Agegroups

### 2006
 
```{r}
decompGEI(x.2006,datenju$agegroup[datenju$steuerjahr==2006])
```


### 2011

```{r}
decompGEI(x.2011,datenju$agegroup[datenju$steuerjahr==2011])
```


#### Interpretation


* Beitrag der Between-Group Ungleichheit zur Overall Ungleichheit ist auch bezüglich Altersgruppen sehr hoch (2006:26.2%) und hat geringfügig zugenommen (2011: 27.0%)
* Verheiratete ohne Kinder verfügen über ein deutlich höheres Einkommen wie die übliche Gruppen



#### Anschlussfrage

* Weshalb ist die Between Group inequality in Jura so viel höher, wie in Basel?



